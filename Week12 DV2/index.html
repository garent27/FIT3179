<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
<script src="vega_lite_vis.js"></script>
<link rel="stylesheet" href="layout.css">
<title>Second Vega-Lite graph </title>
</head>
<body>
<h1>Fastest Rubik's Cube Solves by Country </h1>
<div id="selected-country" style="font-size: 18px; margin: 10px 0; font-weight: bold; color: #333;">
    Selected Country = "None"
</div>
<button id="reset-country" style="margin: 10px 0; padding: 8px 16px; background-color: #007ACC; color: white; border: none; border-radius: 4px; cursor: pointer;">
    Show World Rankings
</button>
<div id="choropleth_map"></div>
    

<h2>Top 5 Fastest Single Solves Ever</h2>
<div id="top5_fastest"></div>

<h2>Top 10 Fastest Countries</h2>
<div id="bar_chart"></div>

<h2>Total Competitions by Country</h2>
<div id="symbol_map"></div>

<h2>Competition Activity: Year vs Continent</h2>
<div id="heatmap"></div>

<h2>Competition Solves by Event</h2>
<div id="treemap"></div>

<h2>Distribution of Solve Times by Category</h2>
<div id="violin_plot"></div>

<h2>Growth of New Competitors by Continent</h2>
<div id="stacked_area"></div>

<h2>Cumulative Competitors by Continent Over Time</h2>
<div id="cumulative_area"></div>

<footer style="margin-top: 40px; padding: 20px; text-align: center; border-top: 1px solid #ddd; background-color: #f9f9f9;">
    <div style="margin: 10px 0; padding: 10px; background-color: #f5f5f5; border-radius: 5px; display: inline-block;">
        <span style="font-size: 14px; color: #666;">Page Views: </span>
        <span id="visitor-count" style="font-weight: bold; color: #007ACC;">Loading...</span>
    </div>
    <p style="margin: 10px 0; font-size: 12px; color: #888;">
        Rubik's Cube Data Visualization Dashboard
    </p>
</footer>

<script>
// Simple visitor counter using multiple fallback methods
window.addEventListener('load', function() {
    const counterElement = document.getElementById('visitor-count');
    
    // Method 1: Try CountAPI with simpler approach
    function tryCountAPI() {
        const url = 'https://api.countapi.xyz/hit/garent27-rubiks-viz/visits';
        
        fetch(url, {
            method: 'GET',
            mode: 'cors'
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            if (data && typeof data.value === 'number') {
                counterElement.textContent = data.value;
            } else {
                throw new Error('Invalid data format');
            }
        })
        .catch(error => {
            console.log('CountAPI failed:', error.message);
            tryGoatCounter();
        });
    }
    
    // Method 2: Try GoatCounter alternative
    function tryGoatCounter() {
        // Simple visitor badge as fallback
        const img = new Image();
        img.onload = function() {
            // If the image loads, we can try to extract count from it
            counterElement.innerHTML = '<img src="https://counter.goatcounter.com/count?p=/rubiks-viz" alt="visitor count" style="vertical-align: middle;">';
        };
        img.onerror = function() {
            console.log('GoatCounter failed, using local storage');
            useLocalStorage();
        };
        img.src = 'https://counter.goatcounter.com/count?p=/rubiks-viz';
    }
    
    // Method 3: Local storage fallback
    function useLocalStorage() {
        let visits = parseInt(localStorage.getItem('rubiks-page-visits') || '0');
        visits += 1;
        localStorage.setItem('rubiks-page-visits', visits.toString());
        counterElement.textContent = `${visits} (session)`;
    }
    
    // Start with CountAPI
    tryCountAPI();
});
</script>

</body>
</html>
